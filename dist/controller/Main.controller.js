function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(!e)return;if(typeof e==="string")return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}function _iterableToArray(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++){a[r]=e[r]}return a}sap.ui.define(["./BaseController"],function(e){"use strict";return e.extend("com.ReformNow.controller.Main",{onInit:function e(){this.viewData={};this.byId("demandList").setNoDataText("зареждаме данните . . .")},onHandleVote:function e(t,r){var a=t.getSource();var o=this.getModel("local");var n=this.getModel("firebase").getObject("/firestore");var i=a.getParent().getBindingContext("local").getPath();var s=o.getProperty(i);var l=this.getModel("firebase").getObject("/auth").currentUser.uid;s.rating=r==="up"?s.rating+1:s.rating-1;s.voters=[].concat(_toConsumableArray(s.voters),[l]);n.collection("demands").doc(s.docID).update({rating:s.rating,voters:s.voters});o.setProperty(i,s);try{a.getParent().getContent()[3].setVisible(false);a.getParent().getContent()[4].setVisible(false)}catch(e){console.log(e)}sap.m.MessageToast.show("Благодарим Ви за гласуването!")},handleOpenAddDialog:function e(){var t=this;if(!this.viewData.AddDialog){this.fragmentLoad("AddDialog").then(function(e){t.viewData.AddDialog=e;t.byId("dateField").setDateValue(new Date);t.viewData.AddDialog.open()})}else{this.viewData.AddDialog.open()}},handleAddGoal:function e(t){var r=this.byId("titleField"),a=this.byId("descrField"),o=this.byId("dateField");var n={title:r.getValue(),description:a.getValue(),rating:1,timestamp:new Date(o.getDateValue()).toJSON(),voters:[this.getModel("firebase").getObject("/auth").currentUser.uid],verified:false,submitedBy:this.getModel("firebase").getObject("/auth").currentUser.uid};this.getModel("firebase").getObject("/firestore").collection("demands").add(n).then(function(e){sap.m.MessageToast.show("Благодарим Ви!")});r.setValue("");a.setValue("");this.handleCloseDialog(t)}})});